---
phase: 01-epub-foundation
plan: 05
type: execute
wave: 4
depends_on: [01-04]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can run the CLI and process EPUB files"
    - "User sees word counts and metadata in table output"
    - "User sees results.md file created in output folder"
    - "Malformed EPUBs are handled gracefully with error messages"
    - "--recursive flag scans subdirectories"
    - "--verbose flag provides detailed output"
    - "Help text is clear and comprehensive"
  artifacts:
    - path: "dist/cli/index.js"
      provides: "Compiled CLI executable"
      min_lines: 50
    - path: "output/results.md"
      provides: "Generated results summary"
      contains: "Summary section, successful table, failed list"
  key_links:
    - from: "CLI execution"
      to: "EPUB processing"
      via: "End-to-end workflow test"
      pattern: "npm run build && node dist/cli/index.js"
---

<objective>
Perform end-to-end testing and validation of the complete EPUB Foundation CLI functionality.

Purpose: Verify that all components work together correctly â€” file discovery, EPUB parsing, metadata extraction, word counting, table output, error handling, and results generation. This is the final validation before Phase 1 is considered complete.

Output: Validated, working CLI that meets all Phase 1 success criteria.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.anning/STATE.md
@.planning/phases/01-epub-foundation/01-CONTEXT.md
@.planning/phases/01-epub-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Phase 1 CLI implementation with all features from Plans 01-04</what-built>
  <how-to-verify>
1. Build the project:
   ```bash
   npm run build
   ```

2. Verify help text displays correctly:
   ```bash
   node dist/cli/index.js --help
   ```
   Expected: Shows all options (--input, --verbose, --recursive) with descriptions

3. Create test environment:
   ```bash
   mkdir -p epubs
   # Add at least 2-3 valid EPUB files to epubs/ folder
   # (Use any EPUB files you have available)
   ```

4. Test default processing (./epubs/ folder):
   ```bash
   node dist/cli/index.js
   ```
   Expected: Table displays with filename, word count, title, author columns

5. Verify output files created:
   ```bash
   ls -la output/
   ```
   Expected: results.md and errors.log (if any errors) exist

6. Review results.md:
   ```bash
   cat output/results.md
   ```
   Expected: Summary section with counts, table of successful EPUBs, list of any failures

7. Test single file mode:
   ```bash
   node dist/cli/index.js epubs/your-file.epub
   ```
   Expected: Processes only the specified file

8. Test recursive flag (if you have subdirectories with EPUBs):
   ```bash
   node dist/cli/index.js --recursive
   ```
   Expected: Scans subdirectories for .epub files

9. Test verbose mode:
   ```bash
   node dist/cli/index.js --verbose
   ```
   Expected: More detailed output during processing

10. Verify .gitignore:
    ```bash
    git status
    ```
    Expected: epubs/, output/, dist/, node_modules/ are NOT shown as untracked

Optional - Test error handling:
- Add a non-EPUB file renamed to .epub (e.g., copy text.txt to fake.epub)
- Run CLI and verify it continues processing, logs error to stderr and errors.log
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe issues to address</resume-signal>
</task>

</tasks>

<verification>
After checkpoint approval:
1. All success criteria from ROADMAP.md Phase 1 are met
2. User can run CLI with various configurations
3. Output files (results.md, errors.log) are created correctly
4. Help text is clear and comprehensive
5. Error handling works as expected
</verification>

<success_criteria>
1. User can run `epub-counter` (via `node dist/cli/index.js`) to process EPUBs
2. User receives word count and metadata for each processed EPUB
3. Tool handles malformed EPUBs gracefully without crashing
4. User can specify custom input folder via --input or positional arguments
5. Help text documents all CLI arguments clearly
6. results.md and errors.log are created in output folder
7. --recursive flag enables subdirectory scanning
8. --verbose flag provides detailed output
9. ./epubs/ is gitignored
10. All Phase 1 requirements from ROADMAP.md are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/01-epub-foundation/01-05-SUMMARY.md`
</output>
